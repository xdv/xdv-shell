name: CI

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Setup DPL
      uses: ./.github/actions/setup-dpl

    - name: Build shell_main
      run: dpl build --sector shell_main

    - name: Build shell_main_tests
      run: dpl build --sector shell_main_tests

    - name: Build shell_loop
      run: dpl build --sector shell_loop

    - name: Build shell_loop_tests
      run: dpl build --sector shell_loop_tests

    - name: Build shell_prompt
      run: dpl build --sector shell_prompt

    - name: Build shell_prompt_tests
      run: dpl build --sector shell_prompt_tests

    - name: Build shell_lexer
      run: dpl build --sector shell_lexer

    - name: Build shell_lexer_tests
      run: dpl build --sector shell_lexer_tests

    - name: Build shell_parser
      run: dpl build --sector shell_parser

    - name: Build shell_parser_tests
      run: dpl build --sector shell_parser_tests

    - name: Build shell_executor
      run: dpl build --sector shell_executor

    - name: Build shell_executor_tests
      run: dpl build --sector shell_executor_tests

    - name: Build shell_completion
      run: dpl build --sector shell_completion

    - name: Build shell_completion_tests
      run: dpl build --sector shell_completion_tests

    - name: Build builtin_cd
      run: dpl build --sector builtin_cd

    - name: Build builtin_cd_tests
      run: dpl build --sector builtin_cd_tests

    - name: Build builtin_ls
      run: dpl build --sector builtin_ls

    - name: Build builtin_ls_tests
      run: dpl build --sector builtin_ls_tests

    - name: Build builtin_cat
      run: dpl build --sector builtin_cat

    - name: Build builtin_cat_tests
      run: dpl build --sector builtin_cat_tests

    - name: Build builtin_mkdir
      run: dpl build --sector builtin_mkdir

    - name: Build builtin_mkdir_tests
      run: dpl build --sector builtin_mkdir_tests

    - name: Build builtin_rm
      run: dpl build --sector builtin_rm

    - name: Build builtin_rm_tests
      run: dpl build --sector builtin_rm_tests

    - name: Build builtin_echo
      run: dpl build --sector builtin_echo

    - name: Build builtin_echo_tests
      run: dpl build --sector builtin_echo_tests

    - name: Build builtin_ps
      run: dpl build --sector builtin_ps

    - name: Build builtin_ps_tests
      run: dpl build --sector builtin_ps_tests

    - name: Build builtin_help
      run: dpl build --sector builtin_help

    - name: Build builtin_help_tests
      run: dpl build --sector builtin_help_tests

    - name: Build builtin_exit
      run: dpl build --sector builtin_exit

    - name: Build builtin_exit_tests
      run: dpl build --sector builtin_exit_tests
